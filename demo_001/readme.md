# step 1 本地一键上传db&github

* 该例子是从node-011拿过来的，
* 状态：前端gulp+后台express。已开发完成。
* 一开始是想完成一键上传db，后面发现只要不是启动server类的，都可以设置为一键启动的方式。
* 于是就有了该项目一键项目的配置。（以后还有更多的优化）目录结构：
```
cmd/
【在该文件夹下面写（一键上传db）命令，且上传的tar包都在该文件夹下面。】
 db_to_ol/ 

【上传GitHub的命令】
 git_to_ol/  

【所有命令行工具的构造函数，_cmd函数promise封装】
 tool.js 
```

* conf.js 在外面，全局参数配置，就单独放在外面了。
```
module.exports = {
  // 数据库名称
  db: "test",

  // 测试模式下的端口
  dev_port: 1010,

  // 打包后/测试时被代理的端口
  api_port: 1011,

  // ===========================服务器的参数
  // ol 登录端口
  login_port: 00000,
  // 登录用户名
  user: "xx",
  // 公网IP
  ip: "00.00.00.00",
  // 线上的上传到的文件夹
  db_dir_ol: 'db_from_out'
}
```

### 1.本地一键上传db

* 本地上传数据库需要做这几件事：导出、打包、上传。
* 在package.json的目录下，使用相对路径打包时，(也就是按照原来想实现scripts命令配置实现)，会把配置的相对路径`./cmd/db_to_ol/test`整个目录结构都打包进行，这个无论我怎么写都是避免不了的。
* 所以：配置的这个`"esc_db": "node ./cmd/db_to_ol/index.js",`实现不了。
* 最后只能在脚本内部使用相对路径，且脚本只能在`db_to_ol`的文件夹下执行该脚本。总结只要是`tar`这种压缩、解压的事情只能是上面的叙述的那样操作。
* 现在是本地上传到线上db数据库已完成。接下来需要实现：线上实时监听上传来的数据库进行数据库合并？见【demo_002】

### 2.本地一键上传GitHub

* 这是由前面想到的，只要不是启动服务的，手动敲代码实现的，都可以配置命令进行一键启动。
* 这个不涉及到打包解压，可用绝对路径。目前设置的是绝对路径，在任何目录都可以执行。
```
  "scripts": {
    "git": "node ./cmd/git_to_ol/index.js"
  },
```
