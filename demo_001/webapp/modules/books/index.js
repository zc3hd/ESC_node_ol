"use strict";function App(n){var i=this;i.index=0,i.find_max_index_key=!0}App.prototype={init:function(){var n=this;n._bind(),n.list(),n.add(),n.edit(),n.del(),n.bgc_change()},_bind:function(){var n=this,i={bgc_change:function(){var n=null;setInterval(function(){n=Math.ceil(1e6*Math.random()),$("#add").css("backgroundColor","#"+n),$("#count").css("backgroundColor","#"+n)},1e3)},add:function(){$("#add").on("click",function(){$.ajax({url:"/api/book/add.do",dataType:"json",type:"POST",data:{title:"title_"+n.index,body:"body_"+n.index}}).done(function(i){n.index++,n.list()})})},list:function(){$.ajax({url:"/api/book/list.do",dataType:"json",type:"POST"}).done(function(i){var t="";$("#list").html(t);var a="",d="",e=null,o=0;i.forEach(function(i,s){n.find_max_index_key&&(e=i.title.split("_"),e[1]=1*e[1],e[1]>o&&(o=e[1],n.index=o,n.index++),n.find_max_index_key=!1),a="",i.users.forEach(function(n,i){a+=n.name+" - "}),i.users=a,d="",i.labels.forEach(function(n,i){d+=n.label+" - "}),i.labels=d,t+='\n              <div class="item">\n                <span>'+i.title+"</span>\n                <span>"+i.body+"</span>\n                <span>"+i.users+"</span>\n                <span>"+i.labels+'</span>\n                <span class="edit" _id='+i._id+'>edit</span>\n                <span class="del" _id='+i._id+">del</span>\n              </div>\n              "}),$("#list").html(t)}),$.ajax({url:"/api/book/count.do",dataType:"json",type:"POST"}).done(function(n){$("#count").html("共 "+n.count+" 条数据")})},edit:function(){$("#list").on("click",".edit",function(i){$.ajax({url:"/api/book/edit.do",dataType:"json",type:"POST",data:{_id:$(i.currentTarget).attr("_id")}}).done(function(i){n.find_max_index_key=!0,n.list()})})},del:function(){$("#list").on("click",".del",function(i){$.ajax({url:"/api/book/del.do",dataType:"json",type:"POST",data:{_id:$(i.currentTarget).attr("_id")}}).done(function(i){n.find_max_index_key=!0,n.list()})})}};for(var t in i)n[t]=i[t]}},(new App).init();